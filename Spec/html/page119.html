<table width="100%"><tr>
<td align=left><A HREF="./page118.html">Page 118</A></td>
<td align=center width="30%"><A HREF="./cover.html">Table of Contents</A></td>
<td align=center width="30%"><A HREF="./index.html">Index</A></td>
<td align=right><A HREF="./page120.html">Page 120</A></td>
</tr>
<tr><td></td><td align=center colspan=2><b>Chapters</b></td><td></td></tr>
<tr><td></td><td align=center colspan=2><b>
<A HREF="./page2.html">1</A>,
<A HREF="./page5.html">2</A>,
<A HREF="./page13.html">3</A>,
<A HREF="./page30.html">4</A>,
<A HREF="./page35.html">5</A>,
<A HREF="./page44.html">6</A>,
<A HREF="./page47.html">7</A>,
<A HREF="./page54.html">8</A>,
<A HREF="./page69.html">9</A>,
<A HREF="./page77.html">10</A>,
<A HREF="./page87.html">11</A>,
<A HREF="./page93.html">12</A>,
<A HREF="./page113.html">13</A>,
<A HREF="./page122.html">14</A>,
<A HREF="./page131.html">15</A>,
<A HREF="./page142.html">16</A>,
<A HREF="./page158.html">17</A>,
<A HREF="./page169.html">18</A>,
<A HREF="./page175.html">19</A>,
<A HREF="./page177.html">20</A>,
<A HREF="./page179.html">21</A>,
<A HREF="./page190.html">22</A>,
<A HREF="./page204.html">23</A>,
<A HREF="./page242.html">24</A>,
<A HREF="./page256.html">25</A>,
<A HREF="./page261.html">26</A>,
<A HREF="./page266.html">27</A>,
<A HREF="./page284.html">28</A>,
<A HREF="./page304.html">29</A>,
<A HREF="./page319.html">30</A><br>
<A HREF="./page336.html">A</A>,
<A HREF="./page343.html">B</A>,
<A HREF="./page348.html">C</A>,
<A HREF="./page354.html">D</A>,
<A HREF="./page357.html">E</A>
</b></td><td></td></tr>
</table>
<hr>
<br>
<br>
 <b>CHAPTER 13. DRAWING IN COLOR </b><br>
<br>
 <big><b>&#061&gt  </b></big><tt>make-opacity </tt><i>value </i>[<i>Function</i>]<br>
 Returns a member of class <tt>opacity </tt>whose opacity is <i>value</i>, which is a real number in the range<br>
 from 0 to 1 (inclusive), where 0 is fully transparent and 1 is fully opaque.<br>
<br>
 The following function returns the sole component of an opacity. This is the only function in the<br>
 opacity protocol. All subclasses of <tt>opacity </tt>must implement methods for this generic function.<br>
<br>
 <big><b>&#061&gt  </b></big><tt>opacity-value </tt><i>opacity </i>[<i>Generic Function</i>]<br>
 Returns the opacity value of the <b>opacity </b><i>opacity</i>, which is a real number in the range from 0 to<br>
 1 (inclusive).<br>
 <br><b>13.5 Color Blending<br><br>
 </b>Drawing a design that is not completely opaque at all points allows the previous contents of the<br>
 drawing plane to show through. The simplest case is drawing a solid design: where the design is<br>
 opaque, it replaces the previous contents of the drawing plane; where the design is transparent,<br>
 it leaves the drawing plane unchanged. In the more general case of drawing a translucent design,<br>
 the resulting color is a blend of the design's color and the previous color of the drawing plane.<br>
 For purposes of color blending, the drawn design is called the foreground and the drawing plane<br>
 is called the background.<br>
<br>
 The function <tt>compose-over </tt>performs a similar operation: it combines two designs to produce<br>
 a design, rather than combining a design and the contents of the drawing plane to produce<br>
 the new contents of the drawing plane. For purposes of color blending, the first argument to<br>
 <tt>compose-over </tt>is called the foreground and the second argument is called the background. See<br>
 <A HREF="./page122.html">Chapter 14</A> for the details of <tt>compose-over</tt>.<br>
<br>
 Color blending is defined by an ideal function
    <big><b>F</b></big>:(<i>r</i><small><sub>1</sub></small><i>,
g</i><small><sub>1</sub></small><i>,
b</i><small><sub>1</sub></small><i>,
o</i><small><sub>1</sub></small><i>,
r</i><small><sub>2</sub></small><i>,
g</i><small><sub>2</sub></small><i>,
b</i><small><sub>2</sub></small><i>,
o</i><small><sub>2</sub></small>) <big><b>-> </b></big>(<i>
r</i><small><sub>3</sub></small><i>,
g</i><small><sub>3</sub></small><i>,
b</i><small><sub>3</sub></small><i>,
o</i><small><sub>3</sub></small>) that<br>
 operates on the color and opacity at a single point. 
(<i>r</i><small><sub>1</sub></small><i>,
g</i><small><sub>1</sub></small><i>,
b</i><small><sub>1</sub></small><i>,
o</i><small><sub>1</sub></small>) are the foreground color and<br>
 opacity. 
(<i>r</i><small><sub>2</sub></small><i>,
g</i><small><sub>2</sub></small><i>,
b</i><small><sub>2</sub></small><i>,
o</i><small><sub>2</sub></small>) are the background color and opacity. 
(<i>r</i><small><sub>3</sub></small><i>,
g</i><small><sub>3</sub></small><i>,
b</i><small><sub>3</sub></small><i>,
o</i><small><sub>3</sub></small>) are the resulting<br>
 color and opacity. The color blending function <big><b>F </b></big>is conceptually applied at every point in the<br>
 drawing plane.<br>
<br>
 <big><b>F </b></big>performs linear interpolation on all four components:<br><br>
<table>
<tr>
	<td align=right width=200><i>o</i><small><sub>3</sub></small> = </td>
	<td align=right><i>o</i><small><sub>1</sub></small> + </td>
	<td>(1 - <i>o</i><small><sub>1</sub></small>) * <i>o</i><small><sub>2</sub></small></td>
      </tr>
<tr>
	<td align=right><i>r</i><small><sub>3</sub></small> = </td>
	<td align=right>(<i>o</i><small><sub>1</sub></small> * <i>r</i><small><sub>1</sub></small> + </td>
	<td>(1 - <i>o</i><small><sub>1</sub></small>) * <i>o</i><small><sub>2</sub></small> *
	  <i>r</i><small><sub>2</sub></small>) / <i>o</i><small><sub>3</sub></small></td>
      </tr>
<tr>
	<td align=right><i>g</i><small><sub>3</sub></small> = </td>
	<td align=right>(<i>o</i><small><sub>1</sub></small> * <i>g</i><small><sub>1</sub></small> + </td>
	<td>(1 - <i>o</i><small><sub>1</sub></small>) * <i>o</i><small><sub>2</sub></small> *
	  <i>g</i><small><sub>2</sub></small>) / <i>o</i><small><sub>3</sub></small></td>
      </tr>
<tr>
	<td align=right><i>b</i><small><sub>3</sub></small> = </td>
	<td align=right>(<i>o</i><small><sub>1</sub></small> * <i>b</i><small><sub>1</sub></small> + </td>
	<td>(1 - <i>o</i><small><sub>1</sub></small>) * <i>o</i><small><sub>2</sub></small> *
	  <i>b</i><small><sub>2</sub></small>) / <i>o</i><small><sub>3</sub></small></td>
      </tr>
</table>
<br>
 Note that if <i>o</i><small><sub>3</sub></small> is zero, these equations would divide zero by zero. In that case <i>r</i><small><sub>3</sub></small> , <i>g</i><small><sub>3</sub></small> , and <i>b</i><small><sub>3</sub></small> are<br>
 defined to be zero.<br><br>
 CLIM requires that <big><b>F </b></big>be implemented exactly if <i>o</i><small><sub>1</sub></small> is zero or one or if <i>o</i><small><sub>2</sub></small> is zero. If <i>o</i><small><sub>1</sub></small> is<br>
 zero, the result is the background. If <i>o</i><small><sub>1</sub></small> is one or <i>o</i><small><sub>2</sub></small> is zero, the result is the foreground. For<br>
 fractional opacity values, an implementation can deviate from the ideal color blending function
<p><hr>
<table width="100%"><tr>
<td align=left><A HREF="./page118.html">Page 118</A></td>
<td align=center width="30%"><A HREF="./cover.html">Table of Contents</A></td>
<td align=center width="30%"><A HREF="./index.html">Index</A></td>
<td align=right><A HREF="./page120.html">Page 120</A></td>
</tr>
<tr><td></td><td align=center colspan=2><b>Chapters</b></td><td></td></tr>
<tr><td></td><td align=center colspan=2><b>
<A HREF="./page2.html">1</A>,
<A HREF="./page5.html">2</A>,
<A HREF="./page13.html">3</A>,
<A HREF="./page30.html">4</A>,
<A HREF="./page35.html">5</A>,
<A HREF="./page44.html">6</A>,
<A HREF="./page47.html">7</A>,
<A HREF="./page54.html">8</A>,
<A HREF="./page69.html">9</A>,
<A HREF="./page77.html">10</A>,
<A HREF="./page87.html">11</A>,
<A HREF="./page93.html">12</A>,
<A HREF="./page113.html">13</A>,
<A HREF="./page122.html">14</A>,
<A HREF="./page131.html">15</A>,
<A HREF="./page142.html">16</A>,
<A HREF="./page158.html">17</A>,
<A HREF="./page169.html">18</A>,
<A HREF="./page175.html">19</A>,
<A HREF="./page177.html">20</A>,
<A HREF="./page179.html">21</A>,
<A HREF="./page190.html">22</A>,
<A HREF="./page204.html">23</A>,
<A HREF="./page242.html">24</A>,
<A HREF="./page256.html">25</A>,
<A HREF="./page261.html">26</A>,
<A HREF="./page266.html">27</A>,
<A HREF="./page284.html">28</A>,
<A HREF="./page304.html">29</A>,
<A HREF="./page319.html">30</A><br>
<A HREF="./page336.html">A</A>,
<A HREF="./page343.html">B</A>,
<A HREF="./page348.html">C</A>,
<A HREF="./page354.html">D</A>,
<A HREF="./page357.html">E</A>
</b></td><td></td></tr>
</table>
