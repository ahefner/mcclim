<table width="100%"><tr>
<td align=left><A HREF="./page242.html">Page 242</A></td>
<td align=center width="30%"><A HREF="./cover.html">Table of Contents</A></td>
<td align=center width="30%"><A HREF="./index.html">Index</A></td>
<td align=right><A HREF="./page244.html">Page 244</A></td>
</tr>
<tr><td></td><td align=center colspan=2><b>Chapters</b></td><td></td></tr>
<tr><td></td><td align=center colspan=2><b>
<A HREF="./page2.html">1</A>,
<A HREF="./page5.html">2</A>,
<A HREF="./page13.html">3</A>,
<A HREF="./page30.html">4</A>,
<A HREF="./page35.html">5</A>,
<A HREF="./page44.html">6</A>,
<A HREF="./page47.html">7</A>,
<A HREF="./page54.html">8</A>,
<A HREF="./page69.html">9</A>,
<A HREF="./page77.html">10</A>,
<A HREF="./page87.html">11</A>,
<A HREF="./page93.html">12</A>,
<A HREF="./page113.html">13</A>,
<A HREF="./page122.html">14</A>,
<A HREF="./page131.html">15</A>,
<A HREF="./page142.html">16</A>,
<A HREF="./page158.html">17</A>,
<A HREF="./page169.html">18</A>,
<A HREF="./page175.html">19</A>,
<A HREF="./page177.html">20</A>,
<A HREF="./page179.html">21</A>,
<A HREF="./page190.html">22</A>,
<A HREF="./page204.html">23</A>,
<A HREF="./page242.html">24</A>,
<A HREF="./page256.html">25</A>,
<A HREF="./page261.html">26</A>,
<A HREF="./page266.html">27</A>,
<A HREF="./page284.html">28</A>,
<A HREF="./page304.html">29</A>,
<A HREF="./page319.html">30</A><br>
<A HREF="./page336.html">A</A>,
<A HREF="./page343.html">B</A>,
<A HREF="./page348.html">C</A>,
<A HREF="./page354.html">D</A>,
<A HREF="./page357.html">E</A>
</b></td><td></td></tr>
</table>
<hr>
<br>
<br>
 <b>CHAPTER 24. INPUT EDITING AND COMPLETION FACILITIES </b><br>
<br>
 The input editing stream may also have other components to store internal state, such as a slot<br>
 to accumulate a numeric argument or remember the most recently used presentation history,<br>
 and so forth. These other components are explicitly left unspecified.<br>
<br>
 The high level description of the operation of the input editor is that it reads either "real"<br>
 gestures from the user (such as characters from the keyboard or pointer button events) or input<br>
 editing commands. The input editing commands can modify the state of the input buffer. When<br>
 such modifications take place, it is necessary to "rescan" the input buffer, that is, reset the scan<br>
 pointer <i>SP </i>to its original state and reparse the contents of the input editor buffer before reading<br>
 any other gestures from the user. While this rescanning operation is taking place, the "rescan<br>
 in progress" flag is set to <b>true</b>. The relationship <i>SP </i><big><b>&lt&#061 </b></big><i>IP </i><big><b>&lt&#061 </b></big><i>FP </i>always holds.<br>
<br>
 The overall control structure of the input editor is:<br>
<pre><tt>
 (catch 'rescan <i>;thrown to when a rescan is invoked</i>
   (reset-scan-pointer stream) <i>;sets STREAM-RESCANNING-P to T</i>
   (loop
     (funcall continuation stream)))

</pre></tt>where <i>stream </i>is the input editing stream and <i>continuation </i>is the code supplied by the pro-<br>
 grammer, and typically contains calls to such functions as <tt>accept </tt>and <tt>read-token </tt>(which will<br>
 eventually call <tt>stream-read-gesture</tt>). When a rescan operation is invoked, it has the effect of<br>
 throwing to the <tt>rescan </tt>tag in the example above. The loop is terminated when an activation<br>
 gesture is seen, and at that point the values produced by <i>continuation </i>are returned as values<br>
 from the input editor.<br>
<br>
 The important point is that functions such as <tt>accept</tt>, <tt>read-gesture</tt>, and <tt>unread-gesture<br>
 </tt>read (or restore) the next gesture object from the buffer at the position pointed to by the scan<br>
 pointer <i>SP</i>. However, insertion and input editing commands take place at the position pointed<br>
 to by <i>IP</i>. The purpose of the rescanning operation is to eventually ensure that all the input<br>
 gestures issued by the user (typed characters, pointer button presses, and so forth) have been<br>
 read by CLIM. During input editing, the input editor should maintain some sort of visible cursor<br>
 to remind the user of the position of <i>IP</i>.<br>
<br>
 The overall structure of <tt>stream-read-gesture </tt>on an input editing stream is:<br>
 <pre><tt>
 (progn
   (rescan-if-necessary stream)
   (loop
     <i>;; If SP is less than FP</i>
     <i>;; Then get the next gesture from the input editor buffer at SP</i>
     <i>;; and increment SP</i>
     <i>;; Else read the next gesture from the encapsulated stream</i>
     <i>;; and insert it into the buffer at IP</i>
     <i>;; Set the "rescan in progress" flag to false</i>
     <i>;; Call STREAM-PROCESS-GESTURE on the gesture</i>
     <i>;; If it was a "real" gesture</i>
     <i>;; Then exit with the gesture as the result</i>
</pre></tt>
<p><hr>
<table width="100%"><tr>
<td align=left><A HREF="./page242.html">Page 242</A></td>
<td align=center width="30%"><A HREF="./cover.html">Table of Contents</A></td>
<td align=center width="30%"><A HREF="./index.html">Index</A></td>
<td align=right><A HREF="./page244.html">Page 244</A></td>
</tr>
<tr><td></td><td align=center colspan=2><b>Chapters</b></td><td></td></tr>
<tr><td></td><td align=center colspan=2><b>
<A HREF="./page2.html">1</A>,
<A HREF="./page5.html">2</A>,
<A HREF="./page13.html">3</A>,
<A HREF="./page30.html">4</A>,
<A HREF="./page35.html">5</A>,
<A HREF="./page44.html">6</A>,
<A HREF="./page47.html">7</A>,
<A HREF="./page54.html">8</A>,
<A HREF="./page69.html">9</A>,
<A HREF="./page77.html">10</A>,
<A HREF="./page87.html">11</A>,
<A HREF="./page93.html">12</A>,
<A HREF="./page113.html">13</A>,
<A HREF="./page122.html">14</A>,
<A HREF="./page131.html">15</A>,
<A HREF="./page142.html">16</A>,
<A HREF="./page158.html">17</A>,
<A HREF="./page169.html">18</A>,
<A HREF="./page175.html">19</A>,
<A HREF="./page177.html">20</A>,
<A HREF="./page179.html">21</A>,
<A HREF="./page190.html">22</A>,
<A HREF="./page204.html">23</A>,
<A HREF="./page242.html">24</A>,
<A HREF="./page256.html">25</A>,
<A HREF="./page261.html">26</A>,
<A HREF="./page266.html">27</A>,
<A HREF="./page284.html">28</A>,
<A HREF="./page304.html">29</A>,
<A HREF="./page319.html">30</A><br>
<A HREF="./page336.html">A</A>,
<A HREF="./page343.html">B</A>,
<A HREF="./page348.html">C</A>,
<A HREF="./page354.html">D</A>,
<A HREF="./page357.html">E</A>
</b></td><td></td></tr>
</table>
